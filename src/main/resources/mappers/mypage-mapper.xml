<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mypageMapper">

   <resultMap id="resultmysubsc" type="Mysubsc">
      <result property="mem_no" column="mem_no" />
      <result property="app_student_no" column="app_student_no"/>
      <result property="mem_name" column="mem_name" />
      <result property="mem_refile" column="mem_refile" />
     </resultMap>

  	<resultMap id="resultQnaBoardSer" type="SelectQnaboard">
		<result property="q_no" column="q_no" />
		<result property="q_title" column="q_title" />
		<result property="q_content" column="q_content" />
		<result property="q_read_cnt" column="q_read_cnt" />
		<result property="q_date" column="q_date" />
		<result property="q_writer" column="q_writer" />
		<result property="q_tcate_id" column="q_tcate_id" />
		<result property="mem_name" column="mem_name" />
		<result property="mem_no" column="mem_no" />
	</resultMap>
	
 	<resultMap id="mypageMember" type="Member">
   <result property="mem_no" column="mem_no" />
      <result property="mem_id" column="mem_id" />
      <result property="app_student_no" column="app_student_no"/>
      <result property="mem_pwd" column="mem_pwd" />
      <result property="mem_name" column="mem_name" />
	</resultMap> 



	<select id="CurrentMemberPwd" resultType="Member" parameterType="Member">
		<![CDATA[
			SELECT mem_pwd FROM MEMBER 
			WHERE MEM_NO = #{MEM_NO} 
		]]>
	</select>
	
	<select id="getListCount" parameterType="hashmap" resultType="_int" >
		<![CDATA[
		select count(*) from myqnaboard
		]]>
		<if test="isKeyword == 1">
		<![CDATA[
		where q_title like #{keyword} and mem_no = #{mem_no}
		]]>
		</if>
		<if test="isKeyword == 0">
		<![CDATA[
		where mem_no = #{mem_no}
		]]>
		</if>
	</select>


	<select id="serviceList" parameterType="hashmap" resultType="list"	resultMap="resultQnaBoardSer">
		<![CDATA[
			select * from 
			(SELECT rownum rnum, a.* FROM myqnaboard a 
		]]>
		<if test="isKeyword == 1">
			<![CDATA[
			where q_title like #{keyword} 
			]]>
		</if>
		<![CDATA[
			order by q_no desc)
			where rnum>= #{startRow} and rnum<=#{endRow}
	  	]]>
	</select>
	
	<select id="serviceMyWrite" parameterType="hashmap" resultType="list"	resultMap="resultQnaBoardSer">
	<![CDATA[
		SELECT * from
		(SELECT rownum rnum, a.* FROM myqnaboard a 
		]]>
		<if test="isKeyword == 1">
			<![CDATA[
			where q_title like #{keyword} 
			]]>
		</if>
	
		<![CDATA[
			order by q_no desc)
			where rnum>= #{startRow} and rnum<=#{endRow}
	  	]]>
		<if test="ismemno == 1">
			<![CDATA[
			 	and mem_no = #{mem_no}
			]]>
		</if>
	</select>
	
	<update id="changeMemInter" >
		 <![CDATA[update member set mem_inter = #{mem_inter} where mem_no = #{mem_no}]]>
	</update>

	<update id="changeMemPwd" >
		 <![CDATA[update member set mem_pwd = #{mem_pwd} where mem_no = #{mem_no}]]>
	</update>

	<update id="changeMemCareer" >
		 <![CDATA[update member set mem_career = #{mem_career} where mem_no = #{mem_no}]]>
	</update>
	
	<delete id="deleteMember" parameterType="int">
		<![CDATA[
		delete from member where mem_no=#{mem_no}
		]]>
	</delete>
	
	<!-- 마이페이지 QNA 내가 쓴 글 상세보기 -->
	<select id="selectmyQnaList" parameterType="_int" resultType="SelectQnaboard"
		resultMap="resultQnaBoardSer">
	<![CDATA[
		SELECT * FROM myqnaboard where q_no = #{sno} 
	]]>
	</select>
	
<!-- 	<select id="checkOldPwd" parameterType="hashmap" resultMap="mypageMember">
	<![CDATA[
		SELECT mem_pwd from member where mem_no = ${mem_no}
		]]>
	</select>  -->

	
	<!-- 준우추가 180313 -->

	<select id="mysubscribe" resultType="Member">
		<![CDATA[
			select * from mysubscribe where app_student_no = #{mem_no}
		]]>
	</select>
	
	<update id="updateMemberImg" parameterType="Member">
 	<![CDATA[
 		update member set mem_orfile = #{mem_orfile}, mem_refile = #{mem_refile} where mem_no=#{mem_no}
 	]]>
	</update>
	
	<update id="updateMemberPassword" parameterType="Member">
 	<![CDATA[
 		update member set mem_pwd = #{mem_pwd} where mem_no=#{mem_no}
 	]]>
	</update>
	
	<delete id="deleteMyQnaService" parameterType="int">
		<![CDATA[
		delete from qnaboard where q_no=#{sno}
		]]>
	</delete>
		
	

</mapper>